<!DOCTYPE html>
<html>
  <head>
    <title>GamePad sample</title>
    <meta charset="utf-8">
  </head>

  <body>
    <article>
      <h1>GamePad Sample</h1>
    </article>

    <script type="module">
      import { GamePads } from './src/main.js';
      import { GamePadMapper } from './src/padMapper.js';

      const gamePads = new GamePads();
      const keys = [
        { name: 'button 1', meta: {} },
        { name: 'button 2', meta: {} },
        { name: 'button 3', meta: {} },
        { name: 'button 4', meta: {} }
      ];
      const padMapper = new GamePadMapper(gamePads, keys);

      gamePads.addEventHandler('connected', async (e) => {
        gamePads.setIndex(0);

        while(!padMapper.captureStepCompleted) {
          await padMapper.stepBy();
        }
        console.log('captured');
        console.log(padMapper.keys);
        padMapper.addEventHandler('buttonChanged', e => console.log(`Button ${e.index} ${e.name} : ${e.value.pressed}`));

        gamePads.capture();
      });
      gamePads.addEventHandler('axisChanged', e => console.log(`Axis ${e.index} : ${e.value}`));
    </script>
  </body>
</html>
